!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){var e=require("path"),r=require("fs"),t=require("babel-plugin-macros");function a(t,n,i,o){void 0===o&&(o="");var l=n.map(function(n){if(Array.isArray(n))return t.objectProperty(t.stringLiteral(n[0]),a(t,n[1],e.join(i,n[0]),o));try{var l=o.startsWith(".")&&n.endsWith(o)?n:n+o,s=require.resolve("./"+l,{paths:[i]});return t.objectProperty(t.stringLiteral(n.replace(o,"")),t.stringLiteral(r.readFileSync(s,"utf-8")))}catch(e){return null}}).filter(Boolean);if(0===l.length)throw new Error("Cannot resolve file "+o+" in these directories: "+n.join(", "));return t.objectExpression(l)}module.exports=(0,t.createMacro)(function(t){var n=t.state,i=t.babel,o={value:0};t.references.default.forEach(function(t){if("CallExpression"!==t.parentPath.type)throw new Error("This is not supported: `"+t.findParent(i.types.isExpression).getSource()+"`. Please see the raw.macro documentation");!function(t){var n,i=t.referencePath,o=t.usageCounter,l=t.babel.types,s=i.parentPath,u=e.dirname(t.state.file.opts.filename),c=s.get("arguments")[0];switch(c.node.type){case"TemplateLiteral":var f=c.node,v=f.expressions,h=f.quasis;if(0===v.length){n=h[0].value.raw;break}try{if(void 0!==(n=s.get("arguments")[0].evaluate().value))break}catch(e){}if(""===h[0].value.raw)throw new Error("Invalid value, variable interpolation can't be at the start of template literal");if(v.length>2)throw new Error("Invalid value. You can only have 2 dynamic values max. 1 for directory name, 1 for file name.");var d="__raw_dynamic__"+o.value;o.value++;var p=v.map(function(e,r){var t=r!==h.length-1&&c.node.quasis[r+1].value.raw.startsWith("/");return{name:e.name,isDirectory:t}}),m=e.join(u,h[0].value.raw),y=r.readdirSync(m).filter(function(t){try{return r.lstatSync(e.join(m,t)).isDirectory()===p[0].isDirectory}catch(e){return!1}}).flatMap(function(e){return p[0].isDirectory?e:e.endsWith(h[1].value.raw)?e.replace(h[1].value.raw,""):[]});return h.slice(1).forEach(function(t,a){p[a].isDirectory&&y.forEach(function(n,i){if(!t.tail){var o=e.join(m,n),l=r.readdirSync(o).filter(function(e){return e.endsWith(h[a+2].value.raw)});y[i]=[n,l]}})}),function e(r){return r.parentPath?e(r.parentPath):r}(i).unshiftContainer("body",l.variableDeclaration("var",[l.variableDeclarator(l.identifier(d),a(l,y,m,h[h.length-1].value.raw))])),void s.replaceWith(l.expressionStatement(p.reduce(function(e,r){return l.memberExpression(e,l.identifier(r.name),!0)},l.identifier(d))));case"StringLiteral":n=c.node.value}if(void 0===n)throw new Error("There was a problem evaluating the value of the argument for the code: "+s.getSource()+". If the value is dynamic, please make sure that its value is statically deterministic.");var g=require.resolve(n,{paths:[u]}),w=r.readFileSync(g,{encoding:"utf-8"});s.replaceWith(l.expressionStatement(l.stringLiteral(w)))}({referencePath:t,state:n,babel:i,usageCounter:o})})})});
//# sourceMappingURL=raw.macro.umd.js.map
